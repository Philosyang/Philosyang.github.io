---
title: "2080. Range Frequency Queries | 1702"
date: 2025-12-03
tags: ["hashing", "binary-search", "python"]
---

I thought it was a prefix sum but I neglected that my initial idea is O(n^2) in memory:

```python
class RangeFreqQuery:
    # intuition
    # we need O(1) query
    # subarray O(1) lookup makes me think of prefix sums
    # e.g., for everything to the left of 1 (inclusive): defaultdict(int) with {12: 1, 33: 1}
    # for everything to the left of 2 (inclusive): defaultdict(int) with {12: 1, 33: 1, 4: 1}
    # query 4 for [1, 2] means prefix2[4] - prefix0[4]
    # NOTE: this intuition MLEs, it is O(n^2) memory

    def __init__(self, arr: List[int]):
        self.n = len(arr)
        self.hash_list = [None] * self.n

        self.hash_list[0] = defaultdict(int)
        self.hash_list[0][arr[0]] += 1
        for i in range(1, self.n):
            temp_dict = self.hash_list[i - 1].copy()
            temp_dict[arr[i]] += 1
            self.hash_list[i] = temp_dict

    def query(self, left: int, right: int, value: int) -> int:
        if left == 0:
            return self.hash_list[right][value]
        return self.hash_list[right][value] - self.hash_list[left - 1][value]


# Your RangeFreqQuery object will be instantiated and called as such:
# obj = RangeFreqQuery(arr)
# param_1 = obj.query(left,right,value)
```

Grouping things by the key being queried:

```python
class RangeFreqQuery:
    # intuition #2
    # for each value, store a sorted list of indices where it appears
    # e.g., 33: [1, 7]
    # we can realize this structure in O(nlogn) with priority queue
    # NOTE: we actually don't need pq at all - since we traverse from left to right, .append promises sorted state
    # then, two binary search for each query solves it

    def __init__(self, arr: List[int]):
        self.d = defaultdict(list)
        for i, value in enumerate(arr):
            self.d[value].append(i)

    def query(self, left: int, right: int, value: int) -> int:
        return bisect_right(self.d[value], right) - bisect_left(self.d[value], left)


# Your RangeFreqQuery object will be instantiated and called as such:
# obj = RangeFreqQuery(arr)
# param_1 = obj.query(left,right,value)
```